<!DOCTYPE html>
<html>
<head>

    <meta http-equiv="context-type" content="text/html" charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="shortcut icon" type="image/png" href="/assets/icon.png">
    <link rel="apple-touch-icon" type="image/png" href="/assets/icon.png">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <link rel="stylesheet" type="text/css" href="/assets/md.css">

    <title>高赛's blog</title>
</head>

<body>

<h1>linux配置ssh公钥认证</h1>

<h3>采用的算法</h3>

<p>rsa  dsa等</p>

<h3>生成公钥和私钥</h3>

<p>ssh-keygen -t rsa</p>

<p>之后会让输入密钥的名字，</p>

<p>如果输入的话会在当前目录生成文件，</p>

<p>如果不输入的话会在~/.ssh/目录下生成id_rsa.pub和id_rsa两个文件</p>

<h3>客户端多私钥配置</h3>

<p><strong><em>问题</em></strong>：如果出现多台server多个私钥文件，在client主机上怎么配置呢？全部追加到 ~/.ssh/id_rsa 中？经测试，这是行不通的，只有第一个私钥可以用，后面的都不行。</p>

<p>在多台server时，可以有两种解决方案。</p>

<p>1、在不同的主机上，使用相同的公钥，则这些机器的私钥也相同。客户端上只需要配置这一个私钥就可以登录所有的主机。</p>

<p>2、不同的主机上使用不同的公钥时， 这时会有多个不同的私钥。这就需要为不同的主机指定不同的私钥文件，这个配置可以在ssh_config中配置，下面展示一下事例文件配置。</p>

<pre><code># 配置文件地址：~/.ssh/config，这就是文件，不是文件夹
Host * #可不要
IdentityFile /etc/mysecret/gaosai #多行为多个私钥
Port 22 #可不要
User root #可不要
</code></pre>

<h3>服务端配置公钥</h3>

<p>把公钥复制到server上，这个步骤其实就是刚生成的id_rsa.pub文件的内容追加到ssh server 的../.ssh/authorized_keys</p>

<p>使用命令</p>

<pre><code>#cd 进入公钥目录
#cd ~/.ssh/
ssh-copy-id -i id_rsa.pub root@127.0.0.1
</code></pre>

<h3>访问即可使用</h3>

<p>ssh root@www.cloud.com</p>

<h3>本地host设置</h3>

<pre><code>cd /etc
vi hosts

127.0.0.1 www.cloud.com

</code></pre>


</body>
</html>
